GET /js/replace_pid.min.js HTTP/1.1
Accept: */*
Referer: http://www.taobao.com/go/act/taoke/iframef5.php?pid=mm_15190792_2147655_8533566
Accept-Language: en-us
Accept-Encoding: gzip, deflate
User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)
Host: cb.alimama.cn
Connection: Keep-Alive

GET /js/replace_pid.min.js HTTP/1.1
Accept: */*
Referer: http://www.taobao.com/go/act/taoke/iframef5.php?pid=mm_15190792_2147655_8533566
Accept-Language: en-us
Accept-Encoding: gzip, deflate
User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)
Host: cb.alimama.cn
Connection: Keep-Alive

 = href.replace(/refpos[=(%3D)]\w*/ig,refpos).replace(reg_26,"%3D" + pid + "%26" + pvid.replace("=","%3D")).replace(reg,pid);
			if(pvid.length > 0){
				href += "&"+pvid; 
			}
			return href;
		}
	}
	com_alimama.util.domReady(replace_pid);
	setTimeout(replace_pid,3000);
})();
HTTP/1.1 200 OK
Content-Type: application/x-javascript; charset=GBK
Content-Length: 2892
Vary: Accept-Encoding
Accept-Ranges: bytes
Server: nginx
Date: Fri, 19 Aug 2011 08:05:15 GMT
Last-Modified: Fri, 01 Jul 2011 03:06:52 GMT
Expires: Fri, 19 Aug 2011 10:05:15 GMT
Cache-Control: max-age=7200
Age: 2586

(function(){
    com_alimama = window.com_alimama || {};
    com_alimama.util = window.com_alimama.util || {};
    
    if ("function" !== typeof(com_alimama.util.domReady)) {
        
		com_alimama.util.domReady = function(f){
			var t = com_alimama.util.domReady;

			if ("function" !== typeof(f)) {
				return;
			}
			if (t.ready) {
				return f();
			}
			if (t.timer) {
				t.fns.push(f);
			}
			else {
				if (window.attachEvent) {
					attachEvent("onload", t.isDomReady);
				}
				else {
					addEventListener("load", t.isDomReady, false);
				}
				t.fns = [f];
				t.isDomReady();
			}
		};
		com_alimama.util.domReady.isDomReady = function(){
			var ts = com_alimama.util.domReady;
			if (ts.ready) {
				return false;
			}
			if (document && document.getElementsByTagName && document.getElementById && document.body) {
				if ("undefined" !== typeof(ts.timer)) {
					clearTimeout(ts.timer);
				}
				ts.timer = null;
				for (var i = 0; i < ts.fns.length; i++) {
					ts.fns[i]();
				}
				ts.fns = null;
				ts.ready = true;
			}
			else {
				ts.timer = setTimeout(ts.isDomReady, 50);
			}
		};

    }

	var isrun = false;
	var replace_pid = function(){
		if(isrun) return;
		var str=window.location.href;
		
		var pid= str.match(/mm_\d{0,24}_\d{0,24}_\d{0,24}/i);
		var pvid = str.match(/[&\?](pvid=[^&]*)/i);
		if(pvid && pvid[1]){
			pvid = pvid[1];
		}else{
			pvid = "";
		}
		var refpos = str.match(/(refpos=(\d{0,24}_\d{0,24}_\d{0,24})?(,[a-z]+)?)(,[a-z]+)?/i);
		if(refpos && refpos[0]){
			refpos = refpos[0];
		}else{
			refpos = "";
		}
		var reg_26=new RegExp("%3Dmm_\\d+_\\d+_\\d+","ig");
		var reg =new RegExp("mm_\\d+_\\d+_\\d+","ig");
		if(pid){
			pid = pid[0];
			var as = document.getElementsByTagName("A");
			for(var i = 0; i < as.length; i++){
				as[i].href=replace_refpos(as[i].href);
			}
			var iframe = document.getElementsByTagName("iframe");
			for(var i = 0; i < iframe.length; i++){
				iframe[i].src=replace_refpos(iframe[i].src);
			}
			var area = document.getElementsByTagName("area");
			for(var i = 0; i < area.length; i++){
				area[i].href=replace_refpos(area[i].href);
			}
			var w = str.match(/w=mmp4ptest[^&]{0,}/i)
			if(w){
				var wreg=new RegExp("w=mmp4ptest[^&]{0,}","gmi");
				for(var i = 0; i < as.length; i++){
					as[i].href=as[i].href.replace(wreg,w[0]);
				}
				for(var i = 0; i < iframe.length; i++){
					iframe[i].src=iframe[i].src.replace(wreg,w[0]);
				}
			}
		}
		isrun = true;
		function replace_refpos(href){
			hrefGET /js/search8/newinf-min.js HTTP/1.1
Accept: */*
Referer: http://www.taobao.com/go/act/mmbd/pd011.php?pid=mm_15190792_2147655_8533566&refpos=,a,null
Accept-Language: en-us
Accept-Encoding: gzip, deflate
User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)
Host: cb.alimama.cn
Connection: Keep-Alive

GET /js/search8/newinf-min.js HTTP/1.1
Accept: */*
Referer: http://www.taobao.com/go/act/mmbd/pd011.php?pid=mm_15190792_2147655_8533566&refpos=,a,null
Accept-Language: en-us
Accept-Encoding: gzip, deflate
User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)
Host: cb.alimama.cn
Connection: Keep-Alive

HTTP/1.1 200 OK
Content-Type: application/x-javascript; charset=GBK
Content-Length: 4002
Vary: Accept-Encoding
Accept-Ranges: bytes
Server: nginx
Date: Fri, 19 Aug 2011 07:46:39 GMT
Last-Modified: Thu, 03 Mar 2011 03:14:12 GMT
Expires: Fri, 19 Aug 2011 09:46:39 GMT
Cache-Control: max-age=7200
Age: 3703

(function(){com_alimama=window.com_alimama||{};if(typeof(com_alimama.getClientInfo)=="function"){return}com_alimama.getClientInfo=function(maxLen){var ci=[],cr="";var ml=maxLen||800;try{ci=ci.concat(com_alimama.getClientInfo._getDynamic(),com_alimama.getClientInfo._getStatic());cr=ci.join("&").substr(0,ml)}catch(err){}return cr};com_alimama.getClientInfo._getDynamic=function(){var cid=[];var bmd=bmd||document;bconfig=[0,1234];var cpr=(typeof(bconfig)=="object"&&bconfig&&bconfig[10])||4973;var cg="",cna="",cks=document.cookie.split(";"),cre=/(^\s*)|(\s*$)/g,cgn,cgm;for(i=0;i<cks.length;i++){cks[i]=cks[i].replace(cre,"");if(cks[i].indexOf("cna=")===0){cna=cks[i].substr(4,24);break}}for(i=1;i<=32;i++){cgn=Math.floor(Math.random()*16);if(cna&&i<=cna.length){cgm=cna.charCodeAt(i-1);cgn=(cgn+cgm)%16}cg+=cgn.toString(16)}cid.push("cg="+cg);cid.push("ac="+Math.floor(Math.random()*10000));(function(){var ct=0;var cn=16;var cs=0;for(var i=1;i<=cn;i++){var cx=Math.random();var cy=Math.random();if((Math.pow(cx,2)+Math.pow(cy,2))<=1){ct++}if(i<=12){cs=cs+cx}}var ck="pr"+String.fromCharCode(97+ct);var cv=(Math.round(cs*cpr)|((bmd.body?bmd.body.clientWidth:0)<<16));cid.push(ck+"="+cv);cid.push("cas="+ck)})();cid.push("cbh="+(bmd.body?bmd.body.clientHeight:-1));cid.push("cbw="+(bmd.body?bmd.body.clientWidth:-1));cid.push("sx=0");cid.push("sy=0");return cid};com_alimama.getClientInfo._getStatic=function(){var cis=[];(function(){var cs=window.screen,cx=0,cy=0,cah=0,caw=0,ccd=0;try{cx=cs.width;cy=cs.height;cah=cs.availHeight;caw=cs.availWidth;ccd=cs.colorDepth}catch(err){}cis.push("re="+cx+"x"+cy);cis.push("cah="+cah);cis.push("caw="+caw);cis.push("ccd="+ccd)})();cis.push("ctz="+(-((new Date()).getTimezoneOffset()/60)));cis.push("chl="+history.length);cis.push("cja="+(navigator.javaEnabled()?"1":"0"));cis.push("cpl="+(navigator.plugins?navigator.plugins.length:0));cis.push("cmm="+(navigator.mimeTypes?navigator.mimeTypes.length:0));(function(){var cv="-1";var cn=navigator;if(cn.plugins&&cn.plugins.length){for(var i=0;i<cn.plugins.length;i++){if(cn.plugins[i].name.indexOf("Shockwave Flash")!=-1){cv=cn.plugins[i].description.split("Shockwave Flash ")[1];break}}}else{if(window.ActiveXObject){for(var j=10;j>=2;j--){try{var cf=eval("new ActiveXObject('ShockwaveFlash.ShockwaveFlash."+j+"');");if(cf){cv=j+".0";break}}catch(err){}}}}if(cv!="-1"){cv=cv.substring(0,cv.indexOf(".")+2)}cis.push("cf="+cv)})();(function(){var cu="";if((self.location!=top.location)&&document.referrer){cu=document.referrer}else{cu=document.location.href}var cr=document.referrer||"";cis.push("u="+encodeURIComponent(cu));cis.push("r="+encodeURIComponent(cr))})();com_alimama.getClientInfo._getStatic=function(){return cis};return cis}})();
/*
 after:com_tanx.p.after
 */
(function(){com_tanx=window.com_tanx||{};com_tanx.p=com_tanx.p||{};com_tanx.p.after=com_tanx.p.after||(function(a,b){window.setTimeout((function(){var c,f,e,g,d;if(!a||!b){return}c=document.createElement("div");c.innerHTML=b;f=a.parentNode;e=a.nextSibling;while(c.childNodes.length!==0){g=c.childNodes[0];if(e){f.insertBefore(g,e)}else{f.appendChild(g)}}c=null}),0)})})();
/*
 com_tanx.p.scriptfile
 */
(function(a){com_tanx=window.com_tanx||{};com_tanx.p=com_tanx.p||{};com_tanx.p[a]=com_tanx.p[a]||(function(d,e){if(e){var b=document.createElement("script");b.charset="gbk";b.async=true;b.src=d.data;document.getElementsByTagName("head")[0].appendChild(b)}else{document.write('<script src="'+d.data+'" charset="gbk"><\/script>')}})})("scriptfile");(function(b){var d,g={},c=0,e;for(;b.length>0;c++){d=b.pop();var f=document.getElementById("tanx-a-"+d.tanx_pid);e=document.getElementById("tanx-a-"+d.ecpm_pid)||document.createElement("a");e.id="tanx-a-"+d.ecpm_pid;e.style.display="none";f.parentNode.insertBefore(e,f);g.pid=d.ecpm_pid;g.width=d.width;g.height=d.height;g.data="http://t.alimama.com/alimama.php?t=i&w="+g.width+"&h="+g.height+"&i="+g.pid+"&"+com_alimama.getClientInfo();com_tanx.p.scriptfile(g,{})}})(ecpm_pid);
GET /js/replace_pid.min.js HTTP/1.1
Accept: */*
Referer: http://www.taobao.com/go/act/taoke/iframediaoyong.php?p=mm_15190792_2147655_8533566
Accept-Language: en-us
Accept-Encoding: gzip, deflate
User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)
Host: cb.alimama.cn
Connection: Keep-Alive

GET /js/replace_pid.min.js HTTP/1.1
Accept: */*
Referer: http://www.taobao.com/go/act/taoke/iframediaoyong.php?p=mm_15190792_2147655_8533566
Accept-Language: en-us
Accept-Encoding: gzip, deflate
User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)
Host: cb.alimama.cn
Connection: Keep-Alive

 = href.replace(/refpos[=(%3D)]\w*/ig,refpos).replace(reg_26,"%3D" + pid + "%26" + pvid.replace("=","%3D")).replace(reg,pid);
			if(pvid.length > 0){
				href += "&"+pvid; 
			}
			return href;
		}
	}
	com_alimama.util.domReady(replace_pid);
	setTimeout(replace_pid,3000);
})();
HTTP/1.1 200 OK
Content-Type: application/x-javascript; charset=GBK
Content-Length: 2892
Vary: Accept-Encoding
Accept-Ranges: bytes
Server: nginx
Date: Fri, 19 Aug 2011 08:05:15 GMT
Last-Modified: Fri, 01 Jul 2011 03:06:52 GMT
Expires: Fri, 19 Aug 2011 10:05:15 GMT
Cache-Control: max-age=7200
Age: 2588

(function(){
    com_alimama = window.com_alimama || {};
    com_alimama.util = window.com_alimama.util || {};
    
    if ("function" !== typeof(com_alimama.util.domReady)) {
        
		com_alimama.util.domReady = function(f){
			var t = com_alimama.util.domReady;

			if ("function" !== typeof(f)) {
				return;
			}
			if (t.ready) {
				return f();
			}
			if (t.timer) {
				t.fns.push(f);
			}
			else {
				if (window.attachEvent) {
					attachEvent("onload", t.isDomReady);
				}
				else {
					addEventListener("load", t.isDomReady, false);
				}
				t.fns = [f];
				t.isDomReady();
			}
		};
		com_alimama.util.domReady.isDomReady = function(){
			var ts = com_alimama.util.domReady;
			if (ts.ready) {
				return false;
			}
			if (document && document.getElementsByTagName && document.getElementById && document.body) {
				if ("undefined" !== typeof(ts.timer)) {
					clearTimeout(ts.timer);
				}
				ts.timer = null;
				for (var i = 0; i < ts.fns.length; i++) {
					ts.fns[i]();
				}
				ts.fns = null;
				ts.ready = true;
			}
			else {
				ts.timer = setTimeout(ts.isDomReady, 50);
			}
		};

    }

	var isrun = false;
	var replace_pid = function(){
		if(isrun) return;
		var str=window.location.href;
		
		var pid= str.match(/mm_\d{0,24}_\d{0,24}_\d{0,24}/i);
		var pvid = str.match(/[&\?](pvid=[^&]*)/i);
		if(pvid && pvid[1]){
			pvid = pvid[1];
		}else{
			pvid = "";
		}
		var refpos = str.match(/(refpos=(\d{0,24}_\d{0,24}_\d{0,24})?(,[a-z]+)?)(,[a-z]+)?/i);
		if(refpos && refpos[0]){
			refpos = refpos[0];
		}else{
			refpos = "";
		}
		var reg_26=new RegExp("%3Dmm_\\d+_\\d+_\\d+","ig");
		var reg =new RegExp("mm_\\d+_\\d+_\\d+","ig");
		if(pid){
			pid = pid[0];
			var as = document.getElementsByTagName("A");
			for(var i = 0; i < as.length; i++){
				as[i].href=replace_refpos(as[i].href);
			}
			var iframe = document.getElementsByTagName("iframe");
			for(var i = 0; i < iframe.length; i++){
				iframe[i].src=replace_refpos(iframe[i].src);
			}
			var area = document.getElementsByTagName("area");
			for(var i = 0; i < area.length; i++){
				area[i].href=replace_refpos(area[i].href);
			}
			var w = str.match(/w=mmp4ptest[^&]{0,}/i)
			if(w){
				var wreg=new RegExp("w=mmp4ptest[^&]{0,}","gmi");
				for(var i = 0; i < as.length; i++){
					as[i].href=as[i].href.replace(wreg,w[0]);
				}
				for(var i = 0; i < iframe.length; i++){
					iframe[i].src=iframe[i].src.replace(wreg,w[0]);
				}
			}
		}
		isrun = true;
		function replace_refpos(href){
			href